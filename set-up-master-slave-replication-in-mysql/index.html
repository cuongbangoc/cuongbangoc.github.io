
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Set Up Master-Slave Replication in MySQL</title>

  <meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1">



<link rel="apple-touch-icon" sizes="57x57" href="../assets/img/apple-touch-icon-57x57.png?v=wAAv6Wqe6l">
<link rel="apple-touch-icon" sizes="60x60" href="../assets/img/apple-touch-icon-60x60.png?v=wAAv6Wqe6l">
<link rel="apple-touch-icon" sizes="72x72" href="../assets/img/apple-touch-icon-72x72.png?v=wAAv6Wqe6l">
<link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-touch-icon-76x76.png?v=wAAv6Wqe6l">
<link rel="apple-touch-icon" sizes="114x114" href="../assets/img/apple-touch-icon-114x114.png?v=wAAv6Wqe6l">
<link rel="apple-touch-icon" sizes="120x120" href="../assets/img/apple-touch-icon-120x120.png?v=wAAv6Wqe6l">
<link rel="apple-touch-icon" sizes="144x144" href="../assets/img/apple-touch-icon-144x144.png?v=wAAv6Wqe6l">
<link rel="apple-touch-icon" sizes="152x152" href="../assets/img/apple-touch-icon-152x152.png?v=wAAv6Wqe6l">
<link rel="apple-touch-icon" sizes="180x180" href="../assets/img/apple-touch-icon-180x180.png?v=wAAv6Wqe6l">
<link rel="icon" type="image/png" href="../assets/img/favicon-32x32.png?v=wAAv6Wqe6l" sizes="32x32">
<link rel="icon" type="image/png" href="../assets/img/favicon-194x194.png?v=wAAv6Wqe6l" sizes="194x194">
<link rel="icon" type="image/png" href="../assets/img/favicon-96x96.png?v=wAAv6Wqe6l" sizes="96x96">
<link rel="icon" type="image/png" href="../assets/img/android-chrome-192x192.png?v=wAAv6Wqe6l" sizes="192x192">
<link rel="icon" type="image/png" href="../assets/img/favicon-16x16.png?v=wAAv6Wqe6l" sizes="16x16">
<link rel="manifest" href="../assets/img/manifest.json?v=wAAv6Wqe6l">
<link rel="shortcut icon" href="../assets/img/favicon.ico?v=wAAv6Wqe6l">
<meta name="msapplication-TileColor" content="#e74c3c">
<meta name="msapplication-TileImage" content="/assets/img/mstile-144x144.png?v=wAAv6Wqe6l">
<meta name="msapplication-config" content="/assets/img/browserconfig.xml?v=wAAv6Wqe6l">
<meta name="theme-color" content="#e74c3c">

  <link rel="stylesheet" type="text/css" href="../assets/css/uno.css?v=cf973ad470">

  <link rel="canonical" href="http://cuongbangoc.github.io/set-up-master-slave-replication-in-mysql/">
    
    <meta property="og:site_name" content="CuongBN - Just Do It">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Set Up Master-Slave Replication in MySQL">
    <meta property="og:description" content="Introduction MySQL replication is a process which allows you have a copies data from MySQL and update automatically from a master to a slave database. It is helpful to backup your data or load balancing in your system. You can...">
    <meta property="og:url" content="http://cuongbangoc.github.io/set-up-master-slave-replication-in-mysql/">
    <meta property="article:published_time" content="2015-03-19T22:40:50.000Z">
    <meta property="article:modified_time" content="2015-08-30T12:30:08.230Z">
    <meta property="article:tag" content="database">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="master">
    <meta property="article:tag" content="mysql">
    <meta property="article:tag" content="replication">
    <meta property="article:tag" content="slave">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Set Up Master-Slave Replication in MySQL">
    <meta name="twitter:description" content="Introduction MySQL replication is a process which allows you have a copies data from MySQL and update automatically from a master to a slave database. It is helpful to backup your data or load balancing in your system. You can...">
    <meta name="twitter:url" content="http://cuongbangoc.github.io/set-up-master-slave-replication-in-mysql/">
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "CuongBN - Just Do It",
    "author": {
        "@type": "Person",
        "name": "Cuong Ba Ngoc",
        "image": "//www.gravatar.com/avatar/6d6e584a65d5852e400df206334e72b1?s=250&d=mm&r=x",
        "url": "http://cuongbangoc.github.io/author/cuongbangoc",
        "sameAs": null,
        "description": null
    },
    "headline": "Set Up Master-Slave Replication in MySQL",
    "url": "http://cuongbangoc.github.io/set-up-master-slave-replication-in-mysql/",
    "datePublished": "2015-03-19T22:40:50.000Z",
    "dateModified": "2015-08-30T12:30:08.230Z",
    "keywords": "database, Linux, master, mysql, replication, slave",
    "description": "Introduction MySQL replication is a process which allows you have a copies data from MySQL and update automatically from a master to a slave database. It is helpful to backup your data or load balancing in your system. You can..."
}
    </script>

    <meta name="generator" content="Ghost 0.6">
    <link rel="alternate" type="application/rss+xml" title="CuongBN - Just Do It" href="http://cuongbangoc.github.io/rss/">
    <script>
var profile_title = 'Cuong Ba Ngoc';
var profile_resume ='Software Engineer';
</script>

</head>
<body class="post-template tag-database tag-linux tag-master tag-mysql tag-replication tag-slave">

  <section id="menu-button" class="expanded">
    <a href="index.html"><i class="icon icon-list"></i></a>
  </section>

  <aside class="cover">

  <div class="cover container">
    <div class="profile">
      <a id="avatar-link" title="link to homepage for CuongBN - Just Do It" href="http://cuongbangoc.github.io/#open">
        <img src="../content/images/2015/08/avatar.jpg" alt="CuongBN - Just Do It avatar" class="profile avatar rounded hvr-buzz-out">
        <h1 id="profile-title">CuongBN - Just Do It</h1>
        <h3 id="profile-resume"></h3>
      </a>

      <hr class="divider long">
      <p>Software Engineer, I'm a man passionate about programming languages, new technologies and open-sources...</p>
      <hr class="divider short">
      <div class="navigation">
        <div class="profile contact">
          <nav class="navigation left">
  <ul class="links">
    <li class="links item">
      <a href="http://cuongbangoc.github.io" class="link-item" title="Home" id="home-button"> Home </a>
      <a href="http://cuongbangoc.github.io/#open" class="link-item" title="CuongBN - Just Do It blog" id="blog-button">Blog</a>
        <a href="../about/" class="link-item" id="-button">About</a>
    </li>
  </ul>
</nav>
          
<nav class="navigation right">
  <ul class="social expanded">

  <!-- Twitter -->
  <!--<li class="social item hvr-grow-rotate">
    <a target="blank" href="http://twitter.com/kikobeats" title="@Kikobeats on Twitter">
      <i class='icon icon-social-twitter'></i>
      <span class="label">Twitter</span>
    </a>
  </li> -->

  <!-- Linkedin -->
  <li class="social item hvr-grow-rotate">
    <a target="blank" href="http://linkedin.com/in/cuongbangoc" title="CuongBaNgoc on LinkedIn">
      <i class="icon icon-social-linkedin"></i>
      <span class="label">Linkedin</span>
    </a>
  </li>

  <!-- Github -->
  <li class="social item hvr-grow-rotate">
    <a target="blank" href="https://github.com/cuongbangoc" title="CuongBaNgoc on Github">
      <i class="icon icon-social-github"></i>
      <span class="label">Github</span>
    </a>
  </li>

  <!-- Facebook -->
    <li class="social item hvr-grow-rotate">
      <a target="blank" href="http://facebook.com/ngoccuongkaka" title="CuongBaNgoc on Facebook">
        <i class="icon icon-social-facebook"></i>
        <span class="label">Facebook</span>
      </a>
    </li>

  <!-- RSS -->
  <li class="social item hvr-grow-rotate">
    <a href="../rss/index.rss" title="Subscribe to RSS">
      <i class="icon icon-rss"></i>
      <span class="label">RSS</span>
    </a>
  </li>

  </ul>
</nav>
          <section class="icon icon-search" id="search-container">
  <hr class="divider short">
  <form id="search-form">
    <input type="text" name="search" placeholder="git, css, javascript,..." id="search-field">
  </form>
</section>
        </div>
      </div>
    </div>
  </div>
</aside>

  <main>
    <section id="search-results"></section>
    <section class="content">
      

  <article class="post tag-database tag-linux tag-master tag-mysql tag-replication tag-slave">
    <header>
      <div class="post meta">
        <time datetime="20 Mar 2015">20 Mar 2015</time>
        <span class="post tags">in <a href="../tag/database/">database</a> <a href="../tag/linux/">Linux</a> <a href="../tag/master/">master</a> <a href="../tag/mysql/">mysql</a> <a href="../tag/replication/">replication</a> <a href="../tag/slave/">slave</a></span>


        <span class="post reading-time"> ~ <span></span> read.</span>
      </div>

      <a alt="Tweet 'Set Up Master-Slave Replication in MySQL'" href="https://twitter.com/intent/tweet?text=Set%20Up%20Master-Slave%20Replication%20in%20MySQL%20%20%C2%BB%20&amp;url=http://cuongbangoc.github.io/set-up-master-slave-replication-in-mysql/">
        
        <h1 class="icon-reverse icon-social-twitter-post" id="post-title">Set Up Master-Slave Replication in MySQL</h1>
      </a>
    </header>

    <div id="post-content" class="post tag-database tag-linux tag-master tag-mysql tag-replication tag-slave">
      <h3 id="introduction">Introduction</h3>

<p>MySQL replication is a process which allows you have a copies data from MySQL and update automatically from a master to a slave database. It is helpful to backup your data or load balancing in your system. You can setup and configure your system to write (Insert, Update, Delete) data by master server , and read data from slave server. All changing data on master server will be updated automatically to slave server.</p>

<p>Today I will show a very simple example of mysql replication—one master will send information to a single slave. For the process to work you will need two IP addresses: one of the master server and one of the slave.</p>

<h3 id="setup">Setup</h3>

<p>This article, I assume that you have user with sudo privileges and have MySQL installed with root account. If you have not MySQL, you can install it by command:</p>

<pre><code class="language-prettyprint lang-bash">sudo apt-get install mysql-server  
</code></pre>

<p>I will use two servers with IP addresses to set up:</p>

<p>– Master : 192.168.1.121</p>

<p>– Slave : 192.168.1.35</p>

<h4 id="steponeconfigurethemasterdatabaseserver">Step one – configure the master database server</h4>

<p>We will open the configuration file on the master database server:</p>

<pre><code class="language-prettyprint lang-bash">sudo vim /etc/mysql/my.cnf  
</code></pre>

<p>We need to make a few changes it.</p>

<p>– The first, we find the binding section, that bind server to the localhost. If it is commented, then we need to remove comment for it.</p>

<pre><code class="language-prettyprint lang-bash">bind-address = 127.0.0.1  
</code></pre>

<p>– After that, we replace 127.0.0.1 to my IP of the master server (192.168.1.121).</p>

<pre><code class="language-prettyprint lang-bash">bind-address = 191.168.1.121  
</code></pre>

<p>– The next, we configure to have server-id. You can choose any number for it, but it must be unique and can not match with any other server-id in your replication group. If it is commented, then let’s uncomment for it.</p>

<pre><code class="language-prettyprint lang-bash">server-id = 1  
</code></pre>

<p>– The next, uncomment for log_bin line, where the real details of the replication are kept. The slave is going to copy all of the changes that are registered in the log.</p>

<pre><code class="language-prettyprint lang-bash">log_bin = /var/log/mysql/mysql-bin.log  
</code></pre>

<p>– Finally, we need to design the database that will be replicated on the slave server. You can include more than one database by repeating this line for all of the databases you will need. Remember, uncomment it.</p>

<pre><code class="language-prettyprint lang-bash">binlog_do_db = replication_database  
</code></pre>

<p>After you make all of the changes, go ahead and save and exit out of the configuration file. Now, we need to restart MySQL.</p>

<pre><code class="language-prettyprint lang-bash">sudo service mysql restart  
</code></pre>

<p>The next step, we will grant privileges to the slave. we need to go to MySQL shell to do it.</p>

<pre><code class="language-prettyprint lang-bash">mysql -u root -p

GRANT REPLICATION SLAVE ON *.* TO 'slave_user'@'%' IDENTIFIED BY 'slave_password';

FLUSH PRIVILEGES;  
</code></pre>

<p>Now, master server should be working properly. You can check by command :</p>

<pre><code class="language-prettyprint lang-bash">SHOW MASTER STATUS;  
</code></pre>

<p>You will see a table that should look something like this:</p>

<pre><code class="language-prettyprint lang-bash">mysql&gt; SHOW MASTER STATUS;  
+------------------+----------+-----------------------+------------------+
|         File     | Position |      Binlog_Do_DB     | Binlog_Ignore_DB | 
+------------------+----------+-----------------------+------------------+ 
| mysql-bin.000001 |   333    |  replication_database |                  | 
+------------------+----------+-----------------------+------------------+ 
1 row in set (0.00 sec)  
</code></pre>

<p>Now, we need to export data in master which will import to slave server. We will run command in terminal:</p>

<pre><code class="language-prettyprint lang-bash">mysqldump -u root -p replication_database &gt; backup.sql  
</code></pre>

<h4 id="steptwoconfiguretheslavedatabaseserver">Step two – configure the slave database server</h4>

<p>We have a master server running, now we will configure for slave server. The first, we need to import master’s data. Log into your slave server and open MySQL shell. We will create database which will be replicated from master server.</p>

<pre><code class="language-prettyprint lang-bash">CREATE DATABASE replication_database; EXIT;  
</code></pre>

<p>Import data by command:</p>

<pre><code class="language-prettyprint lang-bash">mysql -u root -p replication_database &lt; /path/to/backup.sql  
</code></pre>

<p>Now, we will configure slave server in the same way as we did the master:</p>

<pre><code class="language-prettyprint lang-bash">sudo vim /etc/mysql/my.cnf  
</code></pre>

<p>Make some changes:</p>

<pre><code class="language-prettyprint lang-bash">server-id = 2  
relay-log = /var/log/mysql/mysql-relay-bin.log  
log_bin   = /var/log/mysql/mysql-bin.log  
binlog_do_db = replication_database  
</code></pre>

<p><strong>Remember</strong>, uncomment for it. If database name of master and database name of slave are difference, then we will have some changes:</p>

<pre><code class="language-prettyprint lang-bash">server-id = 2  
relay-log = /var/log/mysql/mysql-relay-bin.log  
log_bin   = /var/log/mysql/mysql-bin.log  
binlog_do_db = slave_database_name  
replicate-rewrite-db = master_database_name-&gt;slave_database_name  
</code></pre>

<p>Restart MySQL:</p>

<pre><code class="language-prettyprint lang-bash">sudo service mysql restart  
</code></pre>

<p>The next step is to enable the replication from within the MySQL shell.</p>

<pre><code class="language-prettyprint lang-bash">CHANGE MASTER TO MASTER_HOST='192.168.1.121', \  
MASTER_USER='slave_user', MASTER_PASSWORD='slave_password', \  
MASTER_LOG_FILE='mysql-bin.000001', MASTER_LOG_POS= 333;  
</code></pre>

<p><strong>Note:</strong></p>

<p>– MASTER_HOST: IP address of master server</p>

<p>– MASTER<em>USER and MASTER</em>PASSWORD: that is granted in the master server.</p>

<p>– MASTER<em>LOG</em>FILE and MASTER<em>LOG</em>POS: that is shown when run “SHOW MASTER STATUS”</p>

<p>Activate the slave server:</p>

<pre><code class="language-prettyprint lang-bash">START SLAVE;  
</code></pre>

<p>You be able to see the details of the slave replication by typing in this command. The G rearranges the text to make it more readable.</p>

<pre><code class="language-prettyprint lang-bash">SHOW SLAVE STATUS\G  
</code></pre>

<p>If there is an issue in connecting, you can try starting slave with a command to skip over it:</p>

<pre><code class="language-prettyprint lang-bash">SET GLOBAL SQL_SLAVE_SKIP_COUNTER = 1;  
SLAVE START;  
</code></pre>

<p>All done and we have a replication for master and slave database.</p>
    </div>

    <div class="post related">
        <a rel="prev" id="prev-btn" class="btn small square" href="../set-up-nginx-server-blocks-virtual-hosts-on-ubuntu-14-04/">← Set Up Nginx Server Blocks (Virtual Hosts) on Ubuntu 14.04</a>

        <a rel="next" id="next-btn" class="btn small square" href="../set-up-git-on-ubuntu-14-04/">Set Up Git On Ubuntu 14.04 →</a>
    </div>

    <footer class="post comments">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
  (function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + window.disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</footer>

  </article>


      <footer>
  <span class="copyright">
   <a href="http://cuongbangoc.github.io" style="font-weight: bold;">CuongBa Blog</a> © 2015. All rights reserved. Built with <a href="https://ghost.org/" target="_blank">Ghost</a> and <a href="https://github.com/Kikobeats/uno-zen" target="_blank">Uno Zen</a> theme.
  </span>
</footer>
    </section>
  </main>

  <script src="../public/jquery.js?v=cf973ad470"></script>
  <script type="text/javascript" src="../assets/js/run_prettify.js?v=cf973ad470"></script>
  <script type="text/javascript" src="../assets/js/uno.js?v=cf973ad470"></script>
  <script>
  if (window.ga_id) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', window.ga_id, 'auto');
    ga('require', 'linkid', 'linkid.js');
    ga('send', 'pageview');
  }
</script>
</body>
